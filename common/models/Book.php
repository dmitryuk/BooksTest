<?phpnamespace common\models;use Yii;use yii\web\UploadedFile;/** * This is the model class for table "books". * * @property integer $id * @property integer $author_id * @property string $description * @property resource $image */class Book extends \yii\db\ActiveRecord{    /**     * @inheritdoc     */    public static function tableName()    {        return 'books';    }    public function beforeSave($insert)    {        $image = UploadedFile::getInstance($this, 'image');        if ($image->size>0) {            if($image->hasError)                return false;            $this->image = file_get_contents($image->tempName);            return true;        } else {            if($this->scenario == 'update')                return true;            else {                $this->addError("Ошибка загрузки фото");                return false;            }        }    }    public function getAuthorName(){        return Author::findOne($this->author_id)['name'];    }    public function fields()    {        return [            'id',            'author_id',            'author'=>function($model){                return $model->getAuthorName();            },            'description',        ];    }    public function scenarios()     {        return [            'insert' => [ 'author_id', 'description','image'],            'update' => ['id','author_id', 'description']        ];    }    /**     * @inheritdoc     */    public function rules()    {        return [            [['id', 'author_id', 'description','image'], 'required','on'=>'insert'],            [['id','author_id'],'required','on'=>'update'],            [['id', 'author_id'], 'integer'],            [['description'], 'string','length'=>[5,200]],            ['image','file','maxSize'=>1024*1024]        ];    }    /**     * @inheritdoc     */    public function attributeLabels()    {        return [            'id' => 'ID',            'author_id' => 'Автор',            'description' => 'Описание',            'image' => 'Image',        ];    }    }